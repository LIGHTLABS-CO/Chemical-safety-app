<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dye Mixing Simulator</title>
<style>
  html, body {
    height: 100%;
    margin: 0;
    overflow: hidden;
    background: radial-gradient(circle at center, #fafafa, #e0e0e0);
    font-family: sans-serif;
  }

  canvas {
    width: 100%;
    height: 100%;
    touch-action: none;
    display: block;
  }

  .label {
    position: absolute;
    top: 10px;
    width: 100%;
    text-align: center;
    font-size: 1.2em;
    color: #333;
    user-select: none;
  }
</style>
</head>
<body>
<div class="label">ðŸŒ€ Swipe and mix the dyes</div>
<canvas id="mixCanvas"></canvas>

<script>
const canvas = document.getElementById("mixCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// Dye objects
const dyes = [
  { x: canvas.width * 0.3, y: canvas.height * 0.5, r: 80, color: "#ff0066", vx: 0, vy: 0 },
  { x: canvas.width * 0.7, y: canvas.height * 0.5, r: 80, color: "#0066ff", vx: 0, vy: 0 }
];

let activeDye = null;

function hexToRgb(hex) {
  const bigint = parseInt(hex.replace("#", ""), 16);
  return { r: (bigint >> 16) & 255, g: (bigint >> 8) & 255, b: bigint & 255 };
}

function rgbToHex(r, g, b) {
  return "#" + [r, g, b].map(x => x.toString(16).padStart(2, "0")).join("");
}

function blend(c1, c2, factor) {
  const rgb1 = hexToRgb(c1);
  const rgb2 = hexToRgb(c2);
  const r = Math.round(rgb1.r * (1 - factor) + rgb2.r * factor);
  const g = Math.round(rgb1.g * (1 - factor) + rgb2.g * factor);
  const b = Math.round(rgb1.b * (1 - factor) + rgb2.b * factor);
  return rgbToHex(r, g, b);
}

function distance(a, b) {
  const dx = a.x - b.x;
  const dy = a.y - b.y;
  return Math.sqrt(dx*dx + dy*dy);
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw background smooth gradient based on dye positions
  const mixFactor = Math.max(0, 1 - distance(dyes[0], dyes[1]) / 300);
  const bgColor = blend(dyes[0].color, dyes[1].color, mixFactor);
  document.body.style.background = `radial-gradient(circle at center, ${bgColor}, #222)`;

  dyes.forEach(dye => {
    const gradient = ctx.createRadialGradient(dye.x, dye.y, 10, dye.x, dye.y, dye.r);
    gradient.addColorStop(0, dye.color);
    gradient.addColorStop(1, "rgba(255,255,255,0)");
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(dye.x, dye.y, dye.r, 0, Math.PI * 2);
    ctx.fill();
  });

  requestAnimationFrame(draw);
}

draw();

function getTouchPos(evt) {
  const t = evt.touches ? evt.touches[0] : evt;
  return { x: t.clientX, y: t.clientY };
}

canvas.addEventListener("touchstart", startDrag, { passive: true });
canvas.addEventListener("touchmove", moveDrag, { passive: true });
canvas.addEventListener("touchend", endDrag, { passive: true });
canvas.addEventListener("mousedown", startDrag);
canvas.addEventListener("mousemove", moveDrag);
canvas.addEventListener("mouseup", endDrag);

function startDrag(e) {
  const pos = getTouchPos(e);
  activeDye = dyes.find(d => distance(d, pos) < d.r);
}

function moveDrag(e) {
  if (!activeDye) return;
  const pos = getTouchPos(e);
  activeDye.x = pos.x;
  activeDye.y = pos.y;
}

function endDrag() {
  activeDye = null;
}
</script>
</body>
</html>
